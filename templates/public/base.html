{% load static i18n %}
{% get_current_language as LANGUAGE_CODE %}
{% get_current_language_bidi as LANGUAGE_BIDI %}

<!DOCTYPE html>
<html lang="{{ LANGUAGE_CODE }}" dir="{% if LANGUAGE_BIDI %}rtl{% else %}ltr{% endif %}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>{% block title %}FoxBox{% endblock %}</title>
    {% block stylesheets %}{% endblock %}
    <link rel="stylesheet" href="{% static 'dist/css/styles.css' %}?v={{ CACHE_BUSTER }}">
</head>
<body class="min-h-screen flex flex-col">
{% block header %}
    {% include 'components/header.html' with header_class='default' %}
{% endblock %}
<main class="flex-1">
    {% block content %}{% endblock %}
</main>
{% block footer %}
    {% include 'components/footer.html' with footer_class='mt-8' %}
{% endblock %}

<!-- Глобальные модалки (доступны на всех страницах) -->
{% include 'components/modals/modal-sign-in.html' %}


<!-- Feedback Modal -->
<div class="modal-overlay" id="modal-feedback">
  <form id="feedback-form" class="modal flex flex-col gap-8" data-url="{% url 'feedback_submit' %}">
    {% csrf_token %}
    <div class="modal-header px-4 md:px-6">
      <div class="flex flex-col">
        <div class="pb-1">
          <h3 class="h2 text-center">{% trans "Feedback" %}</h3>
        </div>
        <div>
          <p class="text-center leading-tight font-medium text-gray-700">
            {% trans "Leave a request and our manager will contact you" %}
          </p>
        </div>
      </div>
      <button type="button" class="modal-close [ absolute right-4 top-4 ] w-8 h-8 flex items-center justify-center rounded-full hover:bg-gray-100">
        <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
          <path d="M1 1L13 13M1 13L13 1" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
        </svg>
      </button>
    </div>
    <div class="modal-body px-4 md:px-6 flex flex-col gap-8">
      <div class="grid grid-cols-1 gap-4">
        <div class="flex flex-col gap-2">
          <div class="input-floating">
            <input type="text" id="feedback-name" name="name" placeholder=" " required>
            <label for="feedback-name">{% trans "Name" %} <span class="text-red-500">*</span></label>
          </div>
          <div class="input-error text-xs text-red-500 font-bold hidden"></div>
        </div>

        <div class="flex flex-col gap-2">
          <div class="input-floating">
            <input type="tel" id="feedback-phone" name="phone" placeholder=" " required>
            <label for="feedback-phone">{% trans "Phone" %} <span class="text-red-500">*</span></label>
          </div>
          <div class="input-error text-xs text-red-500 font-bold hidden"></div>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <div class="flex flex-col gap-4 flex-wrap px-4 md:px-6 pb-4 pt-2">
        <div>
          <button type="submit" id="btn-feedback-submit" class="btn-default black lg justify-center w-full flex">
            {% trans "Send a request" %}
          </button>
        </div>
      </div>
    </div>
  </form>
</div>

<!-- Feedback Success -->
<div class="modal-overlay" id="modal-feedback-success">
  <div class="modal flex flex-col gap-8 text-center">
    <div class="modal-header px-4 md:px-6">
      <button type="button" class="modal-close absolute right-4 top-4 w-8 h-8 flex items-center justify-center rounded-full hover:bg-gray-100">
        <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
          <path d="M1 1L13 13M1 13L13 1" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
        </svg>
      </button>
    </div>
    <div class="modal-body px-4 md:px-6 flex flex-col items-center">
      <div class="w-16 h-16 mb-2 bg-green-100 rounded-full flex items-center justify-center">
        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#22c55e" stroke-width="2">
          <polyline points="20 6 9 17 4 12"></polyline>
        </svg>
      </div>
      <h3 class="h2">{% trans "Thank you!" %}</h3>
      <p class="text-gray-700">{% trans "Your request has been sent." %}<br>{% trans "We'll contact you shortly." %}</p>
    </div>
    <div class="modal-footer px-4 md:px-6 pb-4">
      <button type="button" class="btn-default black lg justify-center w-full flex modal-close">
        {% trans "Got it" %}
      </button>
    </div>
  </div>
</div>

<!-- Feedback Error -->
<div class="modal-overlay" id="modal-feedback-error">
  <div class="modal flex flex-col gap-8 text-center">
    <div class="modal-header px-4 md:px-6">
      <button type="button" class="modal-close absolute right-4 top-4 w-8 h-8 flex items-center justify-center rounded-full hover:bg-gray-100">
        <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
          <path d="M1 1L13 13M1 13L13 1" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
        </svg>
      </button>
    </div>
    <div class="modal-body px-4 md:px-6 flex flex-col items-center">
      <div class="w-16 h-16 mb-2 bg-red-100 rounded-full flex items-center justify-center">
        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#ef4444" stroke-width="2">
          <path d="M18 6L6 18M6 6l12 12"></path>
        </svg>
      </div>
      <h3 class="h2">{% trans "Something went wrong" %}</h3>
      <p class="text-gray-700">{% trans "Please try again or contact us directly." %}</p>
    </div>
    <div class="modal-footer px-4 md:px-6 pb-4 flex flex-col gap-2">
      <button type="button" class="btn-default black lg justify-center w-full flex" id="btn-retry-feedback">
        {% trans "Try again" %}
      </button>
      <button type="button" class="modal-close text-gray-700 hover:text-gray-900 py-2 font-bold">
        {% trans "Close" %}
      </button>
    </div>
  </div>
</div>

<!-- Локальные модалки (определяются на страницах) -->
{% block modals %}{% endblock %}

<!-- Local scripts -->
{% block scripts %}{% endblock %}

<script>
const isAuthenticated = {{ user.is_authenticated|yesno:"true,false" }};
</script>

<script src="{% static 'dist/js/main.js' %}?v={{ CACHE_BUSTER }}"></script>
<script src="{% static 'dist/js/validator.js' %}"></script>
</body>
</html>